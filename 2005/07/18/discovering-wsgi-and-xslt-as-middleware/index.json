{
  "attachments": [],
  "comments_archived": true,
  "date": "2005-07-18T19:10:44.000Z",
  "layout": "post",
  "title": "Discovering WSGI and XSLT as middleware",
  "wordpress_id": 670,
  "wordpress_slug": "discovering-wsgi-and-xslt-as-middleware",
  "wordpress_url": "http://www.decafbad.com/blog/?p=670",
  "year": "2005",
  "month": "07",
  "day": "18",
  "isDir": false,
  "slug": "discovering-wsgi-and-xslt-as-middleware",
  "type": "entry",
  "postName": "2005-07-18-discovering-wsgi-and-xslt-as-middleware",
  "html": "<p>As I <a href=\"http://www.decafbad.com/blog/2005/07/18/ajax_testing_and_logging\">mentioned in a previous post</a>, I was a bit busy this weekend while being sick on the couch.  In this post, I'll ramble a bit about my server-side dabbling.  Cutting to the chase, here's an XSLT filter implemented as WSGI middleware:</p>\n<ul>\n<li><a href=\"http://www.decafbad.com/2005/07/xmlwiki/lib/xmlwiki/xslfilter.py\">http://www.decafbad.com/2005/07/xmlwiki/lib/xmlwiki/xslfilter.py</a></li>\n</ul>\n<p>Now you can apply XSLT magic to your REST APIs, like <a href=\"http://www.xml.com/pub/a/2004/08/04/tr-xml.html\">Amazon does with theirs</a>.</p>\n<p><strong>Update</strong>:  Oh yeah and apropos <a href=\"http://an9.org/devdev/why_frameworks_suck?sxip-homesite=&amp;checked=1\">this righteous rant against frameworks</a>, I think one of the reasons I've been so taken with WSGI is that <em>it's not another damn framework</em>.</p>\n<h2 id=\"discovering-wsgi\">Discovering WSGI</h2>\n<p>First off, have you heard of this <a href=\"http://www.python.org/peps/pep-0333.html\">WSGI thing</a> for web apps written in Python?  I had seen some burblings about it some time ago, and got the impression that it was fairly shiny, but I hadn't really bothered wrapping my head around it.  Now that I have gotten it lodged somewhat into my cranium, I wish I'd bought into it years ago.  </p>\n<p>I've been trying to reinvent a decent abstraction for web apps that can run as both CGIs and web-server-resident modules (whether in Apache, SimpleHTTPServer, or who-knows-what) in Python for ages.  I'd found a few different ways to do it, but none as agnostic or no-nonsense as <a href=\"http://www.python.org/peps/pep-0333.html\">WSGI</a>.  And, not only did I find <a href=\"http://www.python.org/peps/pep-0333.html\">WSGI</a> to be clean &amp; simple--<em>I realized that it also makes web apps <strong>composable</strong></em>.</p>\n<p>So, like, if you have a web app that follows the <a href=\"http://www.python.org/peps/pep-0333.html\">WSGI</a> spec, it can be swallowed up by filtering apps.  The filtered apps can have any number of mammoth Python web frameworks powering them, and the filters can be as complex or simple as you want.  Hell, <em>build a web framework entirely out of composed filters</em>!  </p>\n<p>I haven't quite wrapped my head around it yet, but I gather that this is part of the purpose of <a href=\"http://pythonpaste.org/docs/what-is-paste.html\">Python Paste</a>--although I could be wrong.</p>\n<h2 id=\"an-xslt-filter-as-wsgi-middleware\">An XSLT filter as WSGI middleware</h2>\n<p>Anyway, one of the main reasons this composability feature of <a href=\"http://www.python.org/peps/pep-0333.html\">WSGI</a> has me in such an excited state harkens back to two posts I made on <a href=\"http://www.decafbad.com/blog/2004/11/30/nextgenwebapps\">next generation web apps</a> and a <a href=\"http://www.decafbad.com/blog/2004/12/23/abook1\">semi-aborted attempt at a demonstration</a> of such an app.  See, one of the components I've considered to be key to my tinkering with HTTP-and-XML web apps--more specifically, apps centered around REST APIs--is an XSL filter somewhere in the chain.  </p>\n<p>The first place I saw this technique used was with <a href=\"http://www.xml.com/pub/a/2004/08/04/tr-xml.html\">Amazon's Web Services</a> and their REST API which accepts the URL of an XSL stylesheet to be applied as a filter to the XML resulting from a query.  So, you can prepare some XSL of your own and fire off a request to Amazon as a specially-constructed URL--in return, you can magically receive a product search in HTML or even RSS/Atom directly.</p>\n<p>Now, imagine more than that:  Include XSL filtering in a REST API.  Transform the plain old XML results of a GET request into a full-on XHTML/CSS/JavaScript browser-based application primed with that data.  Include the interactive UI for further drill down queries, as well as forms for submitting edits of the data back to the server via POST/PUT/DELETE using XmlHTTPRequest.   </p>\n<p>That's where I'm headed with my experiments, whether I actually get there or not.  In the meantime, I hope the XSLT filter as WSGI middleware is useful to someone.</p>\n<div id=\"comments\" class=\"comments archived-comments\"><h3>Archived Comments</h3>\n<ul class=\"comments\">\n<li class=\"comment\" id=\"comment-221090666\">\n<div class=\"meta\">\n<div class=\"author\">\n<a class=\"avatar image\" rel=\"nofollow\" href=\"http://blog.ianbicking.org\"><img src=\"http://www.gravatar.com/avatar.php?gravatar_id=cc8334869c9d2a9e603017f2da805eb3&amp;size=32&amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png\" width=\"\" height=\"\"></a>\n<a class=\"avatar name\" rel=\"nofollow\" href=\"http://blog.ianbicking.org\">Ian Bicking</a>\n</div>\n\n\n<p><a href=\"#comment-221090666\" class=\"permalink\"><time datetime=\"2005-07-19T01:34:39\">2005-07-19T01:34:39</time></a></p>\n</div>\n\n\n<div class=\"content\">It's cool to see this -- I had actually just mentioned an XSLT\nmiddleware a day ago in an email on Web-SIG about WSGI and possible\nmiddleware, and then there it is.  Incidentally, looking at your code,\nif you want to get rid of the filesystem \"hack\" you can just create a\nwhole new request and capture the output.  An example of that is\npaste.recursive (you'd probably want to just borrow the technique, maybe not the specific module):\nhttp://svn.pythonpaste.org/Paste/trunk/paste/recursive.py\nAnd if you want a place to put\nthis code, there'd certainly be a place in Paste for it as well.</div>\n\n\n</li>\n<li class=\"comment\" id=\"comment-221090667\">\n<div class=\"meta\">\n<div class=\"author\">\n<a class=\"avatar image\" rel=\"nofollow\" href=\"http://webseitz.fluxent.com/wiki\"><img src=\"http://www.gravatar.com/avatar.php?gravatar_id=8157a5907b244071cda98ba5aa7a9635&amp;size=32&amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png\" width=\"\" height=\"\"></a>\n<a class=\"avatar name\" rel=\"nofollow\" href=\"http://webseitz.fluxent.com/wiki\">Bill Seitz</a>\n</div>\n\n\n<p><a href=\"#comment-221090667\" class=\"permalink\"><time datetime=\"2006-04-11T12:17:25\">2006-04-11T12:17:25</time></a></p>\n</div>\n\n\n<div class=\"content\"><p>Are you running WSGI behind Apache? If so, using what Apache plugin protocol? SCGI?</p></div>\n\n\n</li>\n</ul>\n\n\n</div>\n\n\n",
  "body": "As I [mentioned in a previous post][prev], I was a bit busy this weekend while being sick on the couch.  In this post, I'll ramble a bit about my server-side dabbling.  Cutting to the chase, here's an XSLT filter implemented as WSGI middleware:\r\n\r\n[prev]: http://www.decafbad.com/blog/2005/07/18/ajax_testing_and_logging\r\n\r\n* [http://www.decafbad.com/2005/07/xmlwiki/lib/xmlwiki/xslfilter.py](http://www.decafbad.com/2005/07/xmlwiki/lib/xmlwiki/xslfilter.py)\r\n\r\nNow you can apply XSLT magic to your REST APIs, like [Amazon does with theirs][awsxsl].\r\n\r\n**Update**:  Oh yeah and apropos [this righteous rant against frameworks][frame], I think one of the reasons I've been so taken with WSGI is that *it's not another damn framework*.\r\n\r\n[frame]: http://an9.org/devdev/why_frameworks_suck?sxip-homesite=&#38;checked=1\r\n\r\n## Discovering WSGI\r\n\r\nFirst off, have you heard of this [WSGI thing][wsgi] for web apps written in Python?  I had seen some burblings about it some time ago, and got the impression that it was fairly shiny, but I hadn't really bothered wrapping my head around it.  Now that I have gotten it lodged somewhat into my cranium, I wish I'd bought into it years ago.  \r\n\r\nI've been trying to reinvent a decent abstraction for web apps that can run as both CGIs and web-server-resident modules (whether in Apache, SimpleHTTPServer, or who-knows-what) in Python for ages.  I'd found a few different ways to do it, but none as agnostic or no-nonsense as [WSGI][wsgi].  And, not only did I find [WSGI][wsgi] to be clean &#38; simple--*I realized that it also makes web apps **composable***.\r\n\r\nSo, like, if you have a web app that follows the [WSGI][wsgi] spec, it can be swallowed up by filtering apps.  The filtered apps can have any number of mammoth Python web frameworks powering them, and the filters can be as complex or simple as you want.  Hell, *build a web framework entirely out of composed filters*!  \r\n\r\nI haven't quite wrapped my head around it yet, but I gather that this is part of the purpose of [Python Paste][paste]--although I could be wrong.\r\n\r\n[paste]: http://pythonpaste.org/docs/what-is-paste.html\r\n[wsgi]: http://www.python.org/peps/pep-0333.html\r\n\r\n## An XSLT filter as WSGI middleware\r\n\r\nAnyway, one of the main reasons this composability feature of [WSGI][wsgi] has me in such an excited state harkens back to two posts I made on [next generation web apps][ngwa] and a [semi-aborted attempt at a demonstration][abook] of such an app.  See, one of the components I've considered to be key to my tinkering with HTTP-and-XML web apps--more specifically, apps centered around REST APIs--is an XSL filter somewhere in the chain.  \r\n\r\nThe first place I saw this technique used was with [Amazon's Web Services][awsxsl] and their REST API which accepts the URL of an XSL stylesheet to be applied as a filter to the XML resulting from a query.  So, you can prepare some XSL of your own and fire off a request to Amazon as a specially-constructed URL--in return, you can magically receive a product search in HTML or even RSS/Atom directly.\r\n\r\nNow, imagine more than that:  Include XSL filtering in a REST API.  Transform the plain old XML results of a GET request into a full-on XHTML/CSS/JavaScript browser-based application primed with that data.  Include the interactive UI for further drill down queries, as well as forms for submitting edits of the data back to the server via POST/PUT/DELETE using XmlHTTPRequest.   \r\n\r\nThat's where I'm headed with my experiments, whether I actually get there or not.  In the meantime, I hope the XSLT filter as WSGI middleware is useful to someone.\r\n\r\n[awsxsl]: http://www.xml.com/pub/a/2004/08/04/tr-xml.html\r\n[abook]: http://www.decafbad.com/blog/2004/12/23/abook1\r\n[ngwa]: http://www.decafbad.com/blog/2004/11/30/nextgenwebapps\r\n\r\n<div id=\"comments\" class=\"comments archived-comments\">\r\n            <h3>Archived Comments</h3>\r\n            \r\n        <ul class=\"comments\">\r\n            \r\n        <li class=\"comment\" id=\"comment-221090666\">\r\n            <div class=\"meta\">\r\n                <div class=\"author\">\r\n                    <a class=\"avatar image\" rel=\"nofollow\" \r\n                       href=\"http://blog.ianbicking.org\"><img src=\"http://www.gravatar.com/avatar.php?gravatar_id=cc8334869c9d2a9e603017f2da805eb3&amp;size=32&amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png\"/></a>\r\n                    <a class=\"avatar name\" rel=\"nofollow\" \r\n                       href=\"http://blog.ianbicking.org\">Ian Bicking</a>\r\n                </div>\r\n                <a href=\"#comment-221090666\" class=\"permalink\"><time datetime=\"2005-07-19T01:34:39\">2005-07-19T01:34:39</time></a>\r\n            </div>\r\n            <div class=\"content\">It's cool to see this -- I had actually just mentioned an XSLT\r\nmiddleware a day ago in an email on Web-SIG about WSGI and possible\r\nmiddleware, and then there it is.  Incidentally, looking at your code,\r\nif you want to get rid of the filesystem \"hack\" you can just create a\r\nwhole new request and capture the output.  An example of that is\r\npaste.recursive (you'd probably want to just borrow the technique, maybe not the specific module):\r\nhttp://svn.pythonpaste.org/Paste/trunk/paste/recursive.py\r\n\r\nAnd if you want a place to put\r\nthis code, there'd certainly be a place in Paste for it as well.</div>\r\n            \r\n        </li>\r\n    \r\n        <li class=\"comment\" id=\"comment-221090667\">\r\n            <div class=\"meta\">\r\n                <div class=\"author\">\r\n                    <a class=\"avatar image\" rel=\"nofollow\" \r\n                       href=\"http://webseitz.fluxent.com/wiki\"><img src=\"http://www.gravatar.com/avatar.php?gravatar_id=8157a5907b244071cda98ba5aa7a9635&amp;size=32&amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png\"/></a>\r\n                    <a class=\"avatar name\" rel=\"nofollow\" \r\n                       href=\"http://webseitz.fluxent.com/wiki\">Bill Seitz</a>\r\n                </div>\r\n                <a href=\"#comment-221090667\" class=\"permalink\"><time datetime=\"2006-04-11T12:17:25\">2006-04-11T12:17:25</time></a>\r\n            </div>\r\n            <div class=\"content\"><p>Are you running WSGI behind Apache? If so, using what Apache plugin protocol? SCGI?</p></div>\r\n            \r\n        </li>\r\n    \r\n        </ul>\r\n    \r\n        </div>\r\n    ",
  "parentPath": "./content/posts/archives/2005",
  "path": "2005/07/18/discovering-wsgi-and-xslt-as-middleware",
  "prevPostPath": "2005/07/26/a-few-quick-notes-on-podcasts",
  "prevPostTitle": "A Few Quick Notes on Podcasts",
  "nextPostPath": "2005/07/18/ajax-testing-and-logging",
  "nextPostTitle": "AJAX Testing and Logging"
}