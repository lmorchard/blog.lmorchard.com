{"comments_archived":true,"date":"2005-05-08T00:00:00.000Z","layout":"post","title":"What's old (scraping) is new again (microformats)","wordpress_id":643,"wordpress_slug":"whats-old-scraping-is-new-again-microformats","wordpress_url":"http://www.decafbad.com/blog/?p=643","url":"/2005/05/08/whats-old-scraping-is-new-again-microformats/","path":"2005/05/08/whats-old-scraping-is-new-again-microformats","content":"<p>You know, I think I fully realized why microformats seem so appealing and familiar to me:</p>\n<p>The appealing part stems from that fact that I&#39;ve been working on building web scrapers for years now, using a slew of languages (Perl, Java, Python, XSL, JavaScript, bash scripts) and approaches (HTML parsing, regexes, XSL, tidy-and-XPath).  Anything to make that easier strikes a nice chord with me.</p>\n<p>But, I just remembered that a few summers ago, I wrote a bit for <a href=\"http://www.oreilly.com/catalog/spiderhks/toc.html\">the O&#39;Reilly book Spidering Hacks</a> that anticipates the notion of a microformat.  </p>\n<p>If you happen to have the book (which I highly recommend), or can read it on <a href=\"http://safari.oreilly.com/\">Safari</a> (which I also highly recommend), take a look at <strong>Hack #96: Making Your Resources Scrapable with Regular Expressions</strong>.</p>\n<p>Granted, my proto-solution published there suggested using regexes and consistenly named HTML <em>id</em> attributes.  So, I&#39;m much more pleased with the microformat approach using CSS classes.  And, I&#39;m currently trying to write a general microformat parser using Python&#39;s HTMLParser class, which beats using regexes.</p>\n<p>Just thought I&#39;d share the revelation, and toot my own fledgling writing horn. :)</p>\n<div id=\"comments\" class=\"comments archived-comments\">\n            <h3>Archived Comments</h3>\n\n        <ul class=\"comments\">\n\n        <li class=\"comment\" id=\"comment-221084967\">\n            <div class=\"meta\">\n                <div class=\"author\">\n                    <a class=\"avatar image\" rel=\"nofollow\" \n                       href=\"http://blog.ianbicking.org\"><img src=\"http://www.gravatar.com/avatar.php?gravatar_id=cc8334869c9d2a9e603017f2da805eb3&amp;size=32&amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png\"/></a>\n                    <a class=\"avatar name\" rel=\"nofollow\" \n                       href=\"http://blog.ianbicking.org\">Ian Bicking</a>\n                </div>\n                <a href=\"#comment-221084967\" class=\"permalink\"><time datetime=\"2005-05-08T22:25:31\">2005-05-08T22:25:31</time></a>\n            </div>\n            <div class=\"content\">I dunno... HTMLParser and screen scraping has always been an unsatisfying experience to me.  Not very reliable, and fails in unexpected ways.</div>\n\n<pre><code>    &lt;/li&gt;\n\n    &lt;li class=&quot;comment&quot; id=&quot;comment-221084968&quot;&gt;\n        &lt;div class=&quot;meta&quot;&gt;\n            &lt;div class=&quot;author&quot;&gt;\n                &lt;a class=&quot;avatar image&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://www.decafbad.com&quot;&gt;&lt;img src=&quot;http://www.gravatar.com/avatar.php?gravatar_id=eb7f2a3ba74af37415ab7df101a86c75&amp;amp;size=32&amp;amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png&quot;/&gt;&lt;/a&gt;\n                &lt;a class=&quot;avatar name&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://www.decafbad.com&quot;&gt;l.m. orchard&lt;/a&gt;\n            &lt;/div&gt;\n            &lt;a href=&quot;#comment-221084968&quot; class=&quot;permalink&quot;&gt;&lt;time datetime=&quot;2005-05-08T22:55:06&quot;&gt;2005-05-08T22:55:06&lt;/time&gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;content&quot;&gt;Well, scraping is most certainly nothing you want to really rely on without watching it, but I&#39;ve got at least a dozen or two useful and active feeds running as a result of scraping for the past few years-- it&#39;s certainly better than nothing :)&lt;/div&gt;\n\n    &lt;/li&gt;\n\n    &lt;li class=&quot;comment&quot; id=&quot;comment-221084969&quot;&gt;\n        &lt;div class=&quot;meta&quot;&gt;\n            &lt;div class=&quot;author&quot;&gt;\n                &lt;a class=&quot;avatar image&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://taint.org&quot;&gt;&lt;img src=&quot;http://www.gravatar.com/avatar.php?gravatar_id=cfbac1e7edde58ed418d0b08dec00aad&amp;amp;size=32&amp;amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png&quot;/&gt;&lt;/a&gt;\n                &lt;a class=&quot;avatar name&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://taint.org&quot;&gt;Justin Mason&lt;/a&gt;\n            &lt;/div&gt;\n            &lt;a href=&quot;#comment-221084969&quot; class=&quot;permalink&quot;&gt;&lt;time datetime=&quot;2005-05-09T15:50:23&quot;&gt;2005-05-09T15:50:23&lt;/time&gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;content&quot;&gt;ha, I never realised you were one of the authors of that book -- awesome!  I wrote sitescooper, which was a proto-scraper for a wide variety of sites to transcode them into an offline-readable format for small-screen handheld devices.  \n</code></pre><p>I really like the microformat idea, thanks for the pointer.  one difficulty, however, of using it for scraping is that you&#39;ll have to use XPath and trust that the input XHTML is valid.  regexps won&#39;t work, because the close tags don&#39;t include the &quot;id&quot; or &quot;class&quot; attributes, so nested close tags won&#39;t match correctly with simple regexps.</p>\n<p>but then, we&#39;re all told that scraping and regexps are kludges anyway, so I guess we shouldn&#39;t be using them any more ;)</div></p>\n<pre><code>    &lt;/li&gt;\n\n    &lt;li class=&quot;comment&quot; id=&quot;comment-221084970&quot;&gt;\n        &lt;div class=&quot;meta&quot;&gt;\n            &lt;div class=&quot;author&quot;&gt;\n                &lt;a class=&quot;avatar image&quot; rel=&quot;nofollow&quot; \n                   href=&quot;&quot;&gt;&lt;img src=&quot;http://www.gravatar.com/avatar.php?gravatar_id=eb7f2a3ba74af37415ab7df101a86c75&amp;amp;size=32&amp;amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png&quot;/&gt;&lt;/a&gt;\n                &lt;a class=&quot;avatar name&quot; rel=&quot;nofollow&quot; \n                   href=&quot;&quot;&gt;l.m. orchard&lt;/a&gt;\n            &lt;/div&gt;\n            &lt;a href=&quot;#comment-221084970&quot; class=&quot;permalink&quot;&gt;&lt;time datetime=&quot;2005-05-09T16:09:29&quot;&gt;2005-05-09T16:09:29&lt;/time&gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;content&quot;&gt;Well, the thing about the microformats, if I recall, is that you have to at least start with well-formed XHTML.  Otherwise, your microformatted content is broken.\n</code></pre><p>That said, though, I&#39;ve been using Python&#39;s HTMLParser to lift data out of microformat content with a lot of success.</div></p>\n<pre><code>    &lt;/li&gt;\n\n    &lt;li class=&quot;comment&quot; id=&quot;comment-221084971&quot;&gt;\n        &lt;div class=&quot;meta&quot;&gt;\n            &lt;div class=&quot;author&quot;&gt;\n                &lt;a class=&quot;avatar image&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://tantek.com/log/&quot;&gt;&lt;img src=&quot;http://www.gravatar.com/avatar.php?gravatar_id=02cd45622e90350cc061aaaa02229195&amp;amp;size=32&amp;amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png&quot;/&gt;&lt;/a&gt;\n                &lt;a class=&quot;avatar name&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://tantek.com/log/&quot;&gt;Tantek&lt;/a&gt;\n            &lt;/div&gt;\n            &lt;a href=&quot;#comment-221084971&quot; class=&quot;permalink&quot;&gt;&lt;time datetime=&quot;2005-05-09T23:34:35&quot;&gt;2005-05-09T23:34:35&lt;/time&gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;content&quot;&gt;Leslie, that&#39;s exactly right.  More and more blogging tools publish in well-formed XHTML by default and are  becoming better and better at &quot;tidying&quot; ill-formed markup into well-formed markup.  \n</code></pre><p>In addition, right now you can get started with a bit of a hybrid approach:  you can use a regexp to find the <em>start</em> of a microformat such as hCard, hCalendar, hReview, XOXO etc. simply by looking for class attributes that contain the right value.  Then at that point, you can hand the stream over to an XML parser to process the well-formed microformatted markup and handle the structured data as you wish!</p>\n<p>Tantek</div></p>\n<pre><code>    &lt;/li&gt;\n\n    &lt;li class=&quot;comment&quot; id=&quot;comment-221084973&quot;&gt;\n        &lt;div class=&quot;meta&quot;&gt;\n            &lt;div class=&quot;author&quot;&gt;\n                &lt;a class=&quot;avatar image&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://www.metafy.com&quot;&gt;&lt;img src=&quot;http://www.gravatar.com/avatar.php?gravatar_id=314b3139fd18612a532413debb27279a&amp;amp;size=32&amp;amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png&quot;/&gt;&lt;/a&gt;\n                &lt;a class=&quot;avatar name&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://www.metafy.com&quot;&gt;joe @ metafy&lt;/a&gt;\n            &lt;/div&gt;\n            &lt;a href=&quot;#comment-221084973&quot; class=&quot;permalink&quot;&gt;&lt;time datetime=&quot;2005-05-10T14:59:25&quot;&gt;2005-05-10T14:59:25&lt;/time&gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;content&quot;&gt;I remember that presentation at WWDC last year or the year before in which the very nice Sara ? explains that scraping is for H4x0Rs, to which I commented to her afterward that it&#39;s actually for 3L337 H4x0Rs...\n</code></pre><p>I particularly enjoy the &quot;Scraping is Fun&quot; bent of this thread, so I thought I&#39;d bang my own drum a little to show how much I enjoy it, too:</p>\n<p><a href=\"http://www.metafy.com/products/anthracite/\">http://www.metafy.com/products/anthracite/</a></p>\n<p>It works great with Perl (or any other UNIX command) and AppleScript now, and even better later this week when we release the Automator actions for Anthracite (whoops, not supposed to say that yet until they&#39;re all done)...</p>\n<p>Among other nifty things you can do with it today are convert the results of a Google search into an RSS feed, and/or search those results via Spotlight.</p>\n<p>I hope it helps you enjoy scraping even more!</p>\n<p>Joe @ Metafy\nBoulder, Colorado USA</div></p>\n<pre><code>    &lt;/li&gt;\n\n    &lt;li class=&quot;comment&quot; id=&quot;comment-221084975&quot;&gt;\n        &lt;div class=&quot;meta&quot;&gt;\n            &lt;div class=&quot;author&quot;&gt;\n                &lt;a class=&quot;avatar image&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://ransom.dyndns.ws&quot;&gt;&lt;img src=&quot;http://www.gravatar.com/avatar.php?gravatar_id=3c2c53afc4e0af6c1b091b185096a4e5&amp;amp;size=32&amp;amp;default=http://mediacdn.disqus.com/1320279820/images/noavatar32.png&quot;/&gt;&lt;/a&gt;\n                &lt;a class=&quot;avatar name&quot; rel=&quot;nofollow&quot; \n                   href=&quot;http://ransom.dyndns.ws&quot;&gt;Doug Ransom&lt;/a&gt;\n            &lt;/div&gt;\n            &lt;a href=&quot;#comment-221084975&quot; class=&quot;permalink&quot;&gt;&lt;time datetime=&quot;2005-05-23T00:52:56&quot;&gt;2005-05-23T00:52:56&lt;/time&gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=&quot;content&quot;&gt;Here is a microformat I proposed a couple years ago http://internetalchemy.org/2003/04/rssInXHTML\n</code></pre><p>Generally, I think the microformat concept is great.  If an html author can at least use CSS nicely, its trivial to create an RSS with tidy + XSL (or any other way).  Thats useful if their content management system is some sort of lame html editing system that inserts the authors text into a template (i.e. only one page can be created from a single source) rather than generating markup for several pages (html, rss) from a content source.</div></p>\n<pre><code>    &lt;/li&gt;\n\n    &lt;/ul&gt;\n\n    &lt;/div&gt;\n</code></pre>"}